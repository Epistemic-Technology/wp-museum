name: wp-museum
recipe: lemp
config:
  webroot: wordpressexit
  config:  
    vhosts: .lando/nginx.conf
services:
  appserver:
    type: php:custom
    overrides:
      build: .lando
      image: wp-museum/wordpress:8.2
      environment: 
        XDEBUG_MODE:
        XDEBUG_CONFIG:
        WP_TESTS_PHPUNIT_POLYFILLS_PATH: /app/vendor/yoast/phpunit-polyfills
    build_as_root:
      - npm run build
      - /app/.lando/build-wordpress.sh
    config:
      php: .lando/php.ini
  database:
    type: mariadb
    portforward: 3306
    creds:
      user: wordpress
      password: wordpress
      database: wordpress
tooling:
  wp:
      service: appserver
      description: Runs WP-CLI commands
      cmd: wp
  wp-install:
      service: appserver
      description: Installs WordPress with user admin and password admin
      cmd: wp core install --title="WordPress Museum" --admin_user=admin --admin_password=admin --
  phpunit:
      service: appserver
      description: Runs PHPUnit tests
      cmd: phpunit
  install-wp-tests:
      service: appserver
      description: Installs the WordPress test suite
      cmd: /app/.lando/install-wp-tests.sh
  npm:
    service: appserver
    description: Runs npm commands
    cmd: npm
  